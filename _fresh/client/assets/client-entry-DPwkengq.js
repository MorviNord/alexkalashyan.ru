import{l as Z,x as tt,_ as m,k as w,G as et,Q as nt}from"./hooks.module-sR6GeCF4.js";import{w as st,d as rt}from"./signals.module-CAuQLeug.js";typeof globalThis>"u"&&(window.globalThis=window);const ot="/_frsh",it="fresh-partial",x="__frsh_c",v="data-current",U="data-ancestor",lt="data-frsh-key",b="f-client-nav";var q=(function(t){return t.ATTR="attr",t.VNODE="vnode",t.HOOK="__h",t.DIFF="__b",t.RENDER="__r",t.DIFFED="diffed",t.ERROR="__e",t})({}),Y=(function(t){return t[t.None=0]="None",t[t.Ancestor=1]="Ancestor",t[t.Current=2]="Current",t})({});function ct(t,e){let s=new URL(e,"http://localhost").pathname;return s!=="/"&&s.endsWith("/")&&(s=s.slice(0,-1)),t!=="/"&&t.endsWith("/")&&(t=t.slice(0,-1)),t===s?2:t.startsWith(s+"/")||s==="/"?1:0}var A=(function(t){return t[t.Replace=0]="Replace",t[t.Append=1]="Append",t[t.Prepend=2]="Prepend",t})({});function O(t,e){if(!t.startsWith("/")||t.startsWith("//"))return t;try{const s=new URL(t,"https://freshassetcache.local");return s.protocol!=="https:"||s.host!=="freshassetcache.local"||s.searchParams.has(x)?t:(s.searchParams.set(x,e),s.pathname+s.search+s.hash)}catch(s){return console.warn(`Failed to create asset() URL, falling back to regular path ('${t}'):`,s),t}}function at(t,e){if(t.includes("("))return t;const s=t.split(","),i=[];for(const n of s){const r=n.trimStart(),o=n.length-r.length;if(r==="")return t;let l=r.indexOf(" ");l===-1&&(l=r.length);const f=n.substring(0,o),a=r.substring(0,l),c=r.substring(l);i.push(f+O(a,e)+c)}return i.join(",")}function ft(t,e){if(t.type==="img"||t.type==="source"){const{props:s}=t;if(s["data-fresh-disable-lock"])return;typeof s.src=="string"&&(s.src=O(s.src,e)),typeof s.srcset=="string"&&(s.srcset=at(s.srcset,e))}}let W=`b7237d217f0217232dc7780d8146a76a79266286
`;const D=Z,ut=D.vnode;D.vnode=t=>{if(ft(t,W),typeof t.type=="string"&&b in t.props){const e=t.props[b];typeof e=="boolean"&&(t.props[b]=String(e))}t.type,ut?.(t)};const pt=D[q.DIFF];D[q.DIFF]=t=>{pt?.(t)};const dt=-1,ht=-2,mt=-3,gt=-4,yt=-5,bt=-6,Nt=-7;function X(t,e){const s=JSON.parse(t);if(!Array.isArray(s))return y([],[],s,e);const i=new Array(s.length);return y(s,i,0,e),i[0]}function y(t,e,s,i){switch(s){case dt:return;case ht:return null;case mt:return NaN;case gt:return 1/0;case yt:return-1/0;case bt:return-0}if(s in e)return e[s];const n=t[s];if(typeof n=="number")return e[s]=n;if(typeof n=="string"||typeof n=="boolean"||n===null)return e[s]=n;if(Array.isArray(n))if(n.length>0&&typeof n[0]=="string"){const r=n[0];if(i!==void 0&&r in i){const o=i[r],l=n[1],f=y(t,e,l,i);return e[s]=o(f)}switch(r){case"BigInt":return e[s]=BigInt(n[1]);case"URL":return e[s]=new URL(n[1]);case"Date":return e[s]=new Date(n[1]);case"RegExp":return e[s]=new RegExp(n[1],n[2]);case"Set":{const o=new Set;for(let l=0;l<n[1].length;l++){const f=n[1][l];o.add(y(t,e,f,i))}return e[s]=o}case"Map":{const o=new Map;for(let l=0;l<n[1].length;l++){const f=n[1][l++],a=y(t,e,f,i),c=n[1][l],p=y(t,e,c,i);o.set(a,p)}return e[s]=o}case"Uint8Array":return e[s]=At(n[1])}}else{const r=new Array(n.length);e[s]=r;for(let o=0;o<n.length;o++){const l=n[o];l!==Nt&&(r[o]=y(t,e,l,i))}return r}else if(typeof n=="object"){const r={};e[s]=r;const o=Object.keys(n);for(let l=0;l<o.length;l++){const f=o[l],a=n[f];r[f]=y(t,e,a,i)}return r}}function At(t){const e=atob(t),s=e.length,i=new Uint8Array(s);for(let n=0;n<s;n++)i[n]=e.charCodeAt(n);return i}const j=Symbol.for("_FRESH_SLOT");function wt(t){return t!==null&&typeof t=="object"&&"kind"in t&&t.kind===j}const E=new Map;class F extends tt{componentDidMount(){E.set(this.props.name,this)}render(){return this.props.children}}F.displayName="Partial";function $(t,e,s,i,n){const r=()=>{for(const o in t){const l=t[o];if(wt(l)){const f=i.get(l.id);if(f!==void 0){const a=m(w,null),c=V(s,f.start,f.end);R(n,[a],[2],c,f.end),t[o]=a}else{const a=document.querySelector(`#frsh-${l.id}-${l.name}`);if(a!==null){const c=m(w,null);R(n,[c],[2],a.content,null),t[o]=c}}}}et(m(e,t),s)};"scheduler"in window?scheduler.postTask(r):setTimeout(r,0)}const I=new Map,M={Signal:t=>rt(t),Computed:t=>st(()=>t),Slot:t=>({kind:j,name:t.name,id:t.id})};function Et(){return{roots:[],stack:[],slots:new Map,slotIdStack:[]}}function Pt(t,e){const s=Et();G(s,document.body);const i=Object.keys(t);for(let r=0;r<i.length;r++){const o=i[r];I.set(o,t[o])}const n=X(e,M);for(let r=0;r<s.roots.length;r++){const o=s.roots[r],l=V(o.start.parentNode,o.start,o.end);if(o.kind===0){const f=n[o.propsIdx].props,a=I.get(o.name);$(f,a,l,s.slots,n)}else if(o.kind===1){const f={name:o.name,children:null},a=m(w,null);R(n,[a],[1],l,o.end),f.children=a.props.children,$(f,F,l,s.slots,n)}}}function B(t){return t.nodeType===Node.TEXT_NODE&&typeof t._frshMarker=="string"}function g(t){const e=new Text("");return e._frshMarker=t.data,t.parentNode.insertBefore(e,t),t.remove(),e}function G(t,e){if(k(e)){if(e.nodeName==="SCRIPT"||e.nodeName==="STYLE"||t.slotIdStack.length>0)return;for(let s=0;s<e.childNodes.length;s++){const i=e.childNodes[s];G(t,i)}}else if(H(e)){const s=e.data;if(s.startsWith("frsh:")){e=g(e);const i=s.split(":"),n=i[1];if(n==="island"){const r=i[2],o=i[3],l=i[4],f={kind:0,name:r,propsIdx:Number(o),key:l===""?null:l,start:e,end:null};t.stack.length===0&&t.roots.push(f),t.stack.push(f)}else if(n==="slot"){const r=+i[2],o=i[3];t.slotIdStack.push(r),t.slots.set(r,{name:o,start:e,end:null})}else if(n==="partial"){const r=i[2],o=i[3],l={kind:1,name:r,key:o===""?null:o,start:e,end:null};t.stack.length===0&&t.roots.push(l),t.stack.push(l)}}else if(s==="/frsh:island"||s==="/frsh:partial"){e=g(e);const i=t.stack.pop();i!==void 0&&(i.end=e)}else if(s==="/frsh:slot"){e=g(e);const i=t.slotIdStack.pop();i!==void 0&&(t.slots.get(i).end=e)}}}var Rt=(function(t){return t[t.Island=0]="Island",t[t.Partial=1]="Partial",t[t.Slot=2]="Slot",t})({});function Tt(t){return t.children}function R(t,e,s,i,n){let r=i;for(;r!==null;){if(r===n)return;if(r._frshRootFrag||r instanceof DocumentFragment){const o=r.firstChild;o!==null&&R(t,e,s,o,n)}else if(k(r)){const o={};for(let p=0;p<r.attributes.length;p++){const u=r.attributes[p];if(u.nodeName===lt){o.key=u.nodeValue;continue}o[u.nodeName]=typeof r[u.nodeName]=="boolean"?!0:u.nodeValue}const l=m(r.localName,o),f=s.at(-1),a=f===2||f===1;a&&(N(e.at(-1),l),e.push(l));const c=r.firstChild;c!==null&&R(t,e,s,c,n),a&&e.pop()}else if(H(r)||B(r)){const o=B(r)?r._frshMarker:r.data;if(o.startsWith("frsh:")){const l=o.split(":"),f=l[1];if(f==="island"){r=g(r),s.push(0);const a=l[2],c=l[3],p=l[4],u=I.get(a);if(u===void 0)throw new Error(`Encountered unknown island: ${a}`);const d=t[+c].props;d.key=p===""?void 0:p;const h=m(u,d);N(e.at(-1),h),e.push(h)}else if(f==="slot"){r=g(r),s.push(2);const a=+l[2],c=l[3],p=l[4],u=m(Tt,{key:p===""?void 0:p,id:a,name:c,children:[]}),d=e.at(-1);d.props[c]=u,e.push(u)}else if(f==="partial"){r=g(r),s.push(1);const a=l[2],c=+l[3],p=l[4];let u=m(F,{name:a,key:p===""?void 0:p,mode:c});const d=e.at(-1);if(d!==void 0&&N(d,u),c===A.Append){const h=E.get(a);if(h!==void 0){S(u.props,h.props.children);const T=m(w,null);N(u,T),u=T}}else if(c===A.Prepend){const h=E.get(a);if(h!==void 0){S(u.props,h.props.children);const T=m(w,null);u.props.children||(u.props.children=[]),u.props.children.unshift(T),u=T}}e.push(u)}else if(f==="key"){{const c=r;r=r.nextSibling,c.remove()}const a=m(w,{key:l[2]});N(e.at(-1),a),e.push(a);continue}}else o==="/frsh:island"||o==="/frsh:slot"||o==="/frsh:partial"?(e.pop(),s.pop(),r=g(r)):o==="/frsh:key"&&(e.pop(),r=g(r))}else if(_t(r)){const o=s.at(-1);(o===2||o===1)&&N(e.at(-1),r.data)}r=r.nextSibling}}function N(t,e){t.props.children||(t.props.children=[]),t.props.children.push(e)}function S(t,e){t.children=e!=null?Array.isArray(e)?e:[e]:[]}function H(t){return t.nodeType===Node.COMMENT_NODE}function _t(t){return t.nodeType===Node.TEXT_NODE}function k(t){return t.nodeType===Node.ELEMENT_NODE&&!("_frshRootFrag"in t)}function V(t,e,s){const i={_frshRootFrag:!0,nodeType:1,parentNode:t,nextSibling:null,get firstChild(){const n=e.nextSibling;return n===s?null:n},get childNodes(){const n=[];let r=e.nextSibling;for(;r!==null&&r!==s;)n.push(r),r=r.nextSibling;return n},insertBefore(n,r){t.insertBefore(n,r??s)},appendChild(n){t.insertBefore(n,s)},removeChild(n){t.removeChild(n)},contains(n){if(n===null)return!1;const r=i.childNodes;for(let o=0;o<r.length;o++)if(r[o].contains(n))return!0;return!1}};return i}const L="f-partial";class K extends Error{}function C(t){const e=t.closest(`[${b}]`);return e===null?!1:e.getAttribute(b)!=="false"}let _=history.state?.index||0;if(!history.state){const t={fClientNav:!0,index:_,scrollX,scrollY};history.replaceState(t,document.title)}function J(t){if(t.href!==globalThis.location.href){const e={fClientNav:!0,index:_,scrollX:globalThis.scrollX,scrollY:globalThis.scrollY};history.replaceState({...e},"",location.href),_++,e.scrollX=0,e.scrollY=0,history.pushState(e,"",t.href)}}document.addEventListener("click",async t=>{let e=t.target;if(e&&(e instanceof HTMLElement||e instanceof SVGElement)){const s=e;if(e.nodeName!=="A"&&(e=e.closest("a")),e===null&&(e=s.closest("button")),e&&e instanceof HTMLAnchorElement&&e.href&&(!e.target||e.target==="_self")&&e.origin===location.origin&&t.button===0&&!(t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||t.button)&&!t.defaultPrevented){const i=e.getAttribute(L);if(e.getAttribute("href")?.startsWith("#")||!C(e))return;const n=e._freshIndicator;n!==void 0&&(n.value=!0),t.preventDefault();const r=new URL(e.href);try{J(r);const o=new URL(i||r.href,location.href);await P(r,o),z(r),scrollTo({left:0,top:0,behavior:"instant"})}finally{n!==void 0&&(n.value=!1)}}else if(e&&e instanceof HTMLButtonElement&&(e.type!=="submit"||e.form===null)){const i=e.getAttribute(L);if(i===null||!C(e))return;const n=new URL(i,location.href);await P(n,n)}}});addEventListener("popstate",async t=>{if(t.state===null){history.scrollRestoration&&(history.scrollRestoration="auto");return}if(!t.state.fClientNav)return;const e=history.state;_=e.index??_+1;const i=document.querySelector(`[${b}]`);if(i===null||i.getAttribute(b)==="false"){location.reload();return}history.scrollRestoration&&(history.scrollRestoration="manual");const n=new URL(location.href,location.origin);try{await P(n,n),z(n),scrollTo({left:e.scrollX??0,top:e.scrollY??0,behavior:"instant"})}catch(r){if(r instanceof K){location.reload();return}throw r}});document.addEventListener("submit",async t=>{const e=t.target;if(e!==null&&e instanceof HTMLFormElement&&!t.defaultPrevented){if(!C(e)||t.submitter!==null&&!C(t.submitter))return;const s=t.submitter?.getAttribute("formmethod")?.toLowerCase()??e.method.toLowerCase();if(s!=="get"&&s!=="post")return;const i=t.submitter?.getAttribute(L)??t.submitter?.getAttribute("formaction")??e.getAttribute(L)??e.action,n=t.submitter?.getAttribute("formaction")??e.action;if(i!==""){t.preventDefault();const r=new URL(i,location.href),o=new URL(n,location.href);let l;s==="get"?new URLSearchParams(new FormData(e,t.submitter)).forEach((a,c)=>r.searchParams.append(c,a)):l={body:new FormData(e,t.submitter),method:s},await P(o,r,l)}}});function z(t){document.querySelectorAll("a").forEach(e=>{const s=ct(t.pathname,e.href);s===Y.Current?(e.setAttribute(v,"true"),e.setAttribute("aria-current","page"),e.removeAttribute(U)):s===Y.Ancestor?(e.setAttribute(U,"true"),e.setAttribute("aria-current","true"),e.removeAttribute(v)):(e.removeAttribute(v),e.removeAttribute(U),e.removeAttribute("aria-current"))})}async function P(t,e,s={}){s.redirect="follow",e=new URL(e),e.searchParams.set(it,"true");const i=await fetch(e,s);if(i.redirected){const n=new URL(i.url);n.origin===t.origin&&(t=n)}J(t),await It(i)}async function It(t){if(t.headers.get("Content-Type")!=="text/html; charset=utf-8")throw new Error("Unable to process partial response.");const s=t.headers.get("X-Fresh-Id"),i=await t.text(),n=new DOMParser().parseFromString(i,"text/html"),r=n.querySelector(`#__FRSH_STATE_${s}`);let o=[];if(r!==null){const f=JSON.parse(r.textContent),a=[];o=X(f.props,M);for(let c=0;c<f.islands.length;c++){const p=f.islands[c];a.push(import(p.chunk).then(u=>{I.set(p.name,u[p.exportName])}))}await Promise.all(a)}const l={foundPartials:0};if(n.title&&(document.title=n.title),Array.from(n.head.childNodes).forEach(f=>{const a=f;if(a.nodeName!=="TITLE"){if(a.nodeName==="META"){const c=a;if(c.hasAttribute("charset"))return;const p=c.name;if(p!==""){const u=document.head.querySelector(`meta[name="${p}"]`);u!==null?u.content!==c.content&&(u.content=c.content):document.head.appendChild(c)}else{const u=a.getAttribute("property"),d=document.head.querySelector(`meta[property="${u}"]`);d!==null?d.content!==c.content&&(d.content=c.content):document.head.appendChild(c)}}else if(a.nodeName==="LINK"){const c=a;if(c.rel==="modulepreload")return;c.rel==="stylesheet"&&Array.from(document.head.querySelectorAll("link")).find(u=>u.href===c.href)===void 0&&document.head.appendChild(c)}else if(a.nodeName==="SCRIPT"){if(a.src===`${ot}/fresh-runtime.js`)return}else if(a.nodeName==="STYLE"){const c=a;c.id===""&&document.head.appendChild(c)}}}),Q(l,o,n.body),l.foundPartials===0)throw new K(`Found no partials in HTML response. Please make sure to render at least one partial. Requested url: ${t.url}`)}function Q(t,e,s){let i=null,n=s.firstChild,r=0,o="",l="",f=A.Replace;for(;n!==null;){if(H(n)){const a=n.data,c=a.split(":");if(c[0]==="frsh"&&(n=g(n)),c[0]==="frsh"&&c[1]==="partial")++r===1&&(i=n,o=c[2],f=+c[3],l=c[4]);else if(a==="/frsh:partial"){if(t.foundPartials++,--r>0){n=n.nextSibling;continue}const p=V(s,i,n),u=m(F,{key:l!==""?l:void 0,name:o,mode:f,children:null});R(e,[u],[Rt.Partial],p,n);const d=E.get(o);if(d===void 0)console.warn(`Partial "${o}" not found. Skipping...`);else{if(f===A.Replace)d.props.children=u.props.children;else if(f===A.Append){const h=E.get(o);h!==void 0?(S(d.props,h.props.children),d.props.children.push(u.props.children)):d.props.children=u.props.children}else if(f===A.Prepend){const h=E.get(o);h!==void 0?(S(d.props,h.props.children),d.props.children.unshift(u.props.children)):d.props.children=u.props.children}d.setState({})}}}else r===0&&k(n)&&Q(t,e,n);n=n.nextSibling}}nt(!1);const Dt=typeof document<"u";function Ft(t){return O(t,W)}function St(t){return t.children}St.displayName="Partial";export{Dt as IS_BROWSER,St as Partial,Ft as asset,Pt as boot,$ as revive};
