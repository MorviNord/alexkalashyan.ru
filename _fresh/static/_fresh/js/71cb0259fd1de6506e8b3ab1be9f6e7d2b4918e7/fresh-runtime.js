import{a as Q,b as V}from"./chunk-KUVLWYIZ.js";import{a as j,c as h,d as _,e as X,f as J,g as K}from"./chunk-MQAWGMSU.js";typeof globalThis>"u"&&(window.globalThis=window);var I="/_frsh",Ut=`${I}/error_overlay`,Ot=`${I}/alive`,tt="fresh-partial",ht=1e3,mt=ht*60,gt=mt*60,yt=gt*24,Ht=yt*7,B="__frsh_c";var C="data-current",L="data-ancestor",et="data-frsh-key",y="f-client-nav",Y=function(t){return t.ATTR="attr",t.VNODE="vnode",t.HOOK="__h",t.DIFF="__b",t.RENDER="__r",t.DIFFED="diffed",t.ERROR="__e",t}({}),Z=function(t){return t[t.None=0]="None",t[t.Ancestor=1]="Ancestor",t[t.Current=2]="Current",t}({});function nt(t,e){let n=new URL(e,"http://localhost").pathname;return n!=="/"&&n.endsWith("/")&&(n=n.slice(0,-1)),t!=="/"&&t.endsWith("/")&&(t=t.slice(0,-1)),t===n?2:t.startsWith(n+"/")||n==="/"?1:0}var v=function(t){return t[t.Replace=0]="Replace",t[t.Append=1]="Append",t[t.Prepend=2]="Prepend",t}({});function k(t,e){if(!t.startsWith("/")||t.startsWith("//"))return t;try{let n=new URL(t,"https://freshassetcache.local");return n.protocol!=="https:"||n.host!=="freshassetcache.local"||n.searchParams.has(B)?t:(n.searchParams.set(B,e),n.pathname+n.search+n.hash)}catch(n){return console.warn(`Failed to create asset() URL, falling back to regular path ('${t}'):`,n),t}}function rt(t,e){if(t.includes("("))return t;let n=t.split(","),i=[];for(let r of n){let o=r.trimStart(),s=r.length-o.length;if(o==="")return t;let a=o.indexOf(" ");a===-1&&(a=o.length);let f=r.substring(0,s),l=o.substring(0,a),c=o.substring(a);i.push(f+k(l,e)+c)}return i.join(",")}function ot(t,e){if(t.type==="img"||t.type==="source"){let{props:n}=t;if(n["data-fresh-disable-lock"])return;typeof n.src=="string"&&(n.src=k(n.src,e)),typeof n.srcset=="string"&&(n.srcset=rt(n.srcset,e))}}var D="71cb0259fd1de6506e8b3ab1be9f6e7d2b4918e7";var Bt=Array.isArray;var P=j,_t=P.vnode;P.vnode=t=>{if(ot(t,D),typeof t.type=="string"&&y in t.props){let n=t.props[y];typeof n=="boolean"&&(t.props[y]=String(n))}let e=t.type;if(typeof e=="string")switch(e){case"title":case"meta":case"link":case"script":case"style":case"base":case"noscript":case"template":break}_t?.(t)};var vt=P[Y.DIFF];P[Y.DIFF]=t=>{vt?.(t)};function F(t,e){let n=JSON.parse(t);if(!Array.isArray(n))return b([],[],n,e);let i=new Array(n.length);return b(n,i,0,e),i[0]}function b(t,e,n,i){switch(n){case-1:return;case-2:return null;case-3:return NaN;case-4:return 1/0;case-5:return-1/0;case-6:return-0}if(n in e)return e[n];let r=t[n];if(typeof r=="number")return e[n]=r;if(typeof r=="string"||typeof r=="boolean"||r===null)return e[n]=r;if(Array.isArray(r))if(r.length>0&&typeof r[0]=="string"){let o=r[0];if(i!==void 0&&o in i){let s=i[o],a=r[1],f=b(t,e,a,i);return e[n]=s(f)}switch(o){case"BigInt":return e[n]=BigInt(r[1]);case"URL":return e[n]=new URL(r[1]);case"Date":return e[n]=new Date(r[1]);case"RegExp":return e[n]=new RegExp(r[1],r[2]);case"Set":{let s=new Set;for(let a=0;a<r[1].length;a++){let f=r[1][a];s.add(b(t,e,f,i))}return e[n]=s}case"Map":{let s=new Map;for(let a=0;a<r[1].length;a++){let f=r[1][a++],l=b(t,e,f,i),c=r[1][a],p=b(t,e,c,i);s.set(l,p)}return e[n]=s}case"Uint8Array":return e[n]=Rt(r[1])}}else{let o=new Array(r.length);e[n]=o;for(let s=0;s<r.length;s++){let a=r[s];a!==-7&&(o[s]=b(t,e,a,i))}return o}else if(typeof r=="object"){let o={};e[n]=o;let s=Object.keys(r);for(let a=0;a<s.length;a++){let f=s[a],l=r[f];o[f]=b(t,e,l,i)}return o}}function Rt(t){let e=atob(t),n=e.length,i=new Uint8Array(n);for(let r=0;r<n;r++)i[r]=e.charCodeAt(r);return i}var it=Symbol.for("_FRESH_SLOT");function St(t){return t!==null&&typeof t=="object"&&"kind"in t&&t.kind===it}var A=new Map,x=class extends X{componentDidMount(){A.set(this.props.name,this)}render(){return this.props.children}};x.displayName="Partial";function G(t,e,n,i,r){let o=()=>{for(let s in t){let a=t[s];if(St(a)){let f=i.get(a.id);if(f!==void 0){let l=h(_,null),c=H(n,f.start,f.end);N(r,[l],[2],c,f.end),t[s]=l}else{let l=document.querySelector(`#frsh-${a.id}-${a.name}`);if(l!==null){let c=h(_,null);N(r,[c],[2],l.content,null),t[s]=c}}}}J(h(e,t),n)};"scheduler"in window?scheduler.postTask(o):setTimeout(o,0)}var T=new Map,z={Signal:t=>Q(t),Computed:t=>V(()=>t),Slot:t=>({kind:it,name:t.name,id:t.id})};function It(){return{roots:[],stack:[],slots:new Map,slotIdStack:[]}}function Ct(t,e){let n=It();ct(n,document.body);let i=Object.keys(t);for(let o=0;o<i.length;o++){let s=i[o];T.set(s,t[s])}let r=F(e,z);for(let o=0;o<n.roots.length;o++){let s=n.roots[o],a=H(s.start.parentNode,s.start,s.end);if(s.kind===0){let f=r[s.propsIdx].props,l=T.get(s.name);G(f,l,a,n.slots,r)}else if(s.kind===1){let f={name:s.name,children:null},l=h(_,null);N(r,[l],[1],a,s.end),f.children=l.props.children,G(f,x,a,n.slots,r)}}}var at=!1;function st(t){return t.nodeType===Node.TEXT_NODE&&typeof t._frshMarker=="string"}function g(t){if(at)return t;let e=new Text("");return e._frshMarker=t.data,t.parentNode.insertBefore(e,t),t.remove(),e}function ct(t,e){if(O(e)){if(e.nodeName==="SCRIPT"||e.nodeName==="STYLE"||t.slotIdStack.length>0)return;for(let n=0;n<e.childNodes.length;n++){let i=e.childNodes[n];ct(t,i)}}else if(U(e)){let n=e.data;if(n.startsWith("frsh:")){e=g(e);let i=n.split(":"),r=i[1];if(r==="island"){let o=i[2],s=i[3],a=i[4],f={kind:0,name:o,propsIdx:Number(s),key:a===""?null:a,start:e,end:null};t.stack.length===0&&t.roots.push(f),t.stack.push(f)}else if(r==="slot"){let o=+i[2],s=i[3];t.slotIdStack.push(o),t.slots.set(o,{name:s,start:e,end:null})}else if(r==="partial"){let o=i[2],s=i[3],a={kind:1,name:o,key:s===""?null:s,start:e,end:null};t.stack.length===0&&t.roots.push(a),t.stack.push(a)}}else if(n==="/frsh:island"||n==="/frsh:partial"){e=g(e);let i=t.stack.pop();i!==void 0&&(i.end=e)}else if(n==="/frsh:slot"){e=g(e);let i=t.slotIdStack.pop();i!==void 0&&(t.slots.get(i).end=e)}}}var lt=function(t){return t[t.Island=0]="Island",t[t.Partial=1]="Partial",t[t.Slot=2]="Slot",t}({});function Lt(t){return t.children}function N(t,e,n,i,r){let o=i;for(;o!==null;){if(o===r)return;if(o._frshRootFrag||o instanceof DocumentFragment){let s=o.firstChild;s!==null&&N(t,e,n,s,r)}else if(O(o)){let s={};for(let p=0;p<o.attributes.length;p++){let u=o.attributes[p];if(u.nodeName===et){s.key=u.nodeValue;continue}s[u.nodeName]=typeof o[u.nodeName]=="boolean"?!0:u.nodeValue}let a=h(o.localName,s),f=n.at(-1),l=f===2||f===1;l&&(E(e.at(-1),a),e.push(a));let c=o.firstChild;c!==null&&N(t,e,n,c,r),l&&e.pop()}else if(U(o)||st(o)){let s=st(o)?o._frshMarker:o.data;if(s.startsWith("frsh:")){let a=s.split(":"),f=a[1];if(f==="island"){o=g(o),n.push(0);let l=a[2],c=a[3],p=a[4],u=T.get(l);if(u===void 0)throw new Error(`Encountered unknown island: ${l}`);let d=t[+c].props;d.key=p===""?void 0:p;let m=h(u,d);E(e.at(-1),m),e.push(m)}else if(f==="slot"){o=g(o),n.push(2);let l=+a[2],c=a[3],p=a[4],u=h(Lt,{key:p===""?void 0:p,id:l,name:c,children:[]}),d=e.at(-1);d.props[c]=u,e.push(u)}else if(f==="partial"){o=g(o),n.push(1);let l=a[2],c=+a[3],p=a[4],u=h(x,{name:l,key:p===""?void 0:p,mode:c}),d=e.at(-1);if(d!==void 0&&E(d,u),c===v.Append){let m=A.get(l);if(m!==void 0){R(u.props,m.props.children);let w=h(_,null);E(u,w),u=w}}else if(c===v.Prepend){let m=A.get(l);if(m!==void 0){R(u.props,m.props.children);let w=h(_,null);u.props.children||(u.props.children=[]),u.props.children.unshift(w),u=w}}e.push(u)}else if(f==="key"){if(!at){let c=o;o=o.nextSibling,c.remove()}let l=h(_,{key:a[2]});E(e.at(-1),l),e.push(l);continue}}else s==="/frsh:island"||s==="/frsh:slot"||s==="/frsh:partial"?(e.pop(),n.pop(),o=g(o)):s==="/frsh:key"&&(e.pop(),o=g(o))}else if(kt(o)){let s=n.at(-1);(s===2||s===1)&&E(e.at(-1),o.data)}o=o.nextSibling}}function E(t,e){t.props.children||(t.props.children=[]),t.props.children.push(e)}function R(t,e){t.children=e!=null?Array.isArray(e)?e:[e]:[]}function U(t){return t.nodeType===Node.COMMENT_NODE}function kt(t){return t.nodeType===Node.TEXT_NODE}function O(t){return t.nodeType===Node.ELEMENT_NODE&&!("_frshRootFrag"in t)}function H(t,e,n){let i={_frshRootFrag:!0,nodeType:1,parentNode:t,nextSibling:null,get firstChild(){let r=e.nextSibling;return r===n?null:r},get childNodes(){let r=[],o=e.nextSibling;for(;o!==null&&o!==n;)r.push(o),o=o.nextSibling;return r},insertBefore(r,o){t.insertBefore(r,o??n)},appendChild(r){t.insertBefore(r,n)},removeChild(r){t.removeChild(r)},contains(r){if(r===null)return!1;let o=i.childNodes;for(let s=0;s<o.length;s++)if(o[s].contains(r))return!0;return!1}};return i}var $="f-partial",M=class extends Error{};function W(t){let e=t.closest(`[${y}]`);return e===null?!1:e.getAttribute(y)!=="false"}var S=history.state?.index||0;if(!history.state){let t={fClientNav:!0,index:S,scrollX,scrollY};history.replaceState(t,document.title)}function ft(t){if(t.href!==globalThis.location.href){let e={fClientNav:!0,index:S,scrollX:globalThis.scrollX,scrollY:globalThis.scrollY};history.replaceState({...e},"",location.href),S++,e.scrollX=0,e.scrollY=0,history.pushState(e,"",t.href)}}document.addEventListener("click",async t=>{let e=t.target;if(e&&(e instanceof HTMLElement||e instanceof SVGElement)){let n=e;if(e.nodeName!=="A"&&(e=e.closest("a")),e===null&&(e=n.closest("button")),e&&e instanceof HTMLAnchorElement&&e.href&&(!e.target||e.target==="_self")&&e.origin===location.origin&&t.button===0&&!(t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||t.button)&&!t.defaultPrevented){let i=e.getAttribute($);if(e.getAttribute("href")?.startsWith("#")||!W(e))return;let r=e._freshIndicator;r!==void 0&&(r.value=!0),t.preventDefault();let o=new URL(e.href);try{ft(o);let s=new URL(i||o.href,location.href);await q(o,s),ut(o),scrollTo({left:0,top:0,behavior:"instant"})}finally{r!==void 0&&(r.value=!1)}}else if(e&&e instanceof HTMLButtonElement&&(e.type!=="submit"||e.form===null)){let i=e.getAttribute($);if(i===null||!W(e))return;let r=new URL(i,location.href);await q(r,r)}}});addEventListener("popstate",async t=>{if(t.state===null){history.scrollRestoration&&(history.scrollRestoration="auto");return}if(!t.state.fClientNav)return;let e=history.state;S=e.index??S+1;let i=document.querySelector(`[${y}]`);if(i===null||i.getAttribute(y)==="false"){location.reload();return}history.scrollRestoration&&(history.scrollRestoration="manual");let r=new URL(location.href,location.origin);try{await q(r,r),ut(r),scrollTo({left:e.scrollX??0,top:e.scrollY??0,behavior:"instant"})}catch(o){if(o instanceof M){location.reload();return}throw o}});document.addEventListener("submit",async t=>{let e=t.target;if(e!==null&&e instanceof HTMLFormElement&&!t.defaultPrevented){if(!W(e)||t.submitter!==null&&!W(t.submitter))return;let n=t.submitter?.getAttribute("formmethod")?.toLowerCase()??e.method.toLowerCase();if(n!=="get"&&n!=="post")return;let i=t.submitter?.getAttribute($)??t.submitter?.getAttribute("formaction")??e.getAttribute($)??e.action,r=t.submitter?.getAttribute("formaction")??e.action;if(i!==""){t.preventDefault();let o=new URL(i,location.href),s=new URL(r,location.href),a;n==="get"?new URLSearchParams(new FormData(e,t.submitter)).forEach((l,c)=>o.searchParams.append(c,l)):a={body:new FormData(e,t.submitter),method:n},await q(s,o,a)}}});function ut(t){document.querySelectorAll("a").forEach(e=>{let n=nt(t.pathname,e.href);n===Z.Current?(e.setAttribute(C,"true"),e.setAttribute("aria-current","page"),e.removeAttribute(L)):n===Z.Ancestor?(e.setAttribute(L,"true"),e.setAttribute("aria-current","true"),e.removeAttribute(C)):(e.removeAttribute(C),e.removeAttribute(L),e.removeAttribute("aria-current"))})}async function q(t,e,n={}){n.redirect="follow",e=new URL(e),e.searchParams.set(tt,"true");let i=await fetch(e,n);if(i.redirected){let r=new URL(i.url);r.origin===t.origin&&(t=r)}ft(t),await Dt(i)}async function Dt(t){if(t.headers.get("Content-Type")!=="text/html; charset=utf-8")throw new Error("Unable to process partial response.");let n=t.headers.get("X-Fresh-Id"),i=await t.text(),r=new DOMParser().parseFromString(i,"text/html"),o=r.querySelector(`#__FRSH_STATE_${n}`),s=[];if(o!==null){let f=JSON.parse(o.textContent),l=[];s=F(f.props,z);for(let c=0;c<f.islands.length;c++){let p=f.islands[c];l.push(import(p.chunk).then(u=>{T.set(p.name,u[p.exportName])}))}await Promise.all(l)}let a={foundPartials:0};if(r.title&&(document.title=r.title),Array.from(r.head.childNodes).forEach(f=>{let l=f;if(l.nodeName!=="TITLE"){if(l.nodeName==="META"){let c=l;if(c.hasAttribute("charset"))return;let p=c.name;if(p!==""){let u=document.head.querySelector(`meta[name="${p}"]`);u!==null?u.content!==c.content&&(u.content=c.content):document.head.appendChild(c)}else{let u=l.getAttribute("property"),d=document.head.querySelector(`meta[property="${u}"]`);d!==null?d.content!==c.content&&(d.content=c.content):document.head.appendChild(c)}}else if(l.nodeName==="LINK"){let c=l;if(c.rel==="modulepreload")return;c.rel==="stylesheet"&&Array.from(document.head.querySelectorAll("link")).find(u=>u.href===c.href)===void 0&&document.head.appendChild(c)}else if(l.nodeName==="SCRIPT"){if(l.src===`${I}/fresh-runtime.js`)return}else if(l.nodeName==="STYLE"){let c=l;c.id===""&&document.head.appendChild(c)}}}),pt(a,s,r.body),a.foundPartials===0)throw new M(`Found no partials in HTML response. Please make sure to render at least one partial. Requested url: ${t.url}`)}function pt(t,e,n){let i=null,r=n.firstChild,o=0,s="",a="",f=v.Replace;for(;r!==null;){if(U(r)){let l=r.data,c=l.split(":");if(c[0]==="frsh"&&(r=g(r)),c[0]==="frsh"&&c[1]==="partial")++o===1&&(i=r,s=c[2],f=+c[3],a=c[4]);else if(l==="/frsh:partial"){if(t.foundPartials++,--o>0){r=r.nextSibling;continue}let p=H(n,i,r),u=h(x,{key:a!==""?a:void 0,name:s,mode:f,children:null});N(e,[u],[lt.Partial],p,r);let d=A.get(s);if(d===void 0)console.warn(`Partial "${s}" not found. Skipping...`);else{if(f===v.Replace)d.props.children=u.props.children;else if(f===v.Append){let m=A.get(s);m!==void 0?(R(d.props,m.props.children),d.props.children.push(u.props.children)):d.props.children=u.props.children}else if(f===v.Prepend){let m=A.get(s);m!==void 0?(R(d.props,m.props.children),d.props.children.unshift(u.props.children)):d.props.children=u.props.children}d.setState({})}}}else o===0&&O(r)&&pt(t,e,r);r=r.nextSibling}}var ye=K(!1);var Pt=typeof document<"u";function Ft(t){return k(t,D)}function dt(t){return t.children}dt.displayName="Partial";export{Pt as IS_BROWSER,dt as Partial,Ft as asset,Ct as boot,G as revive};
